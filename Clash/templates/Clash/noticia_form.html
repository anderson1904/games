{% extends 'Clash/base.html' %}

{% block content %}
<div class="form-box"> <h2>Criar Nova Notícia</h2>
    <hr>
    
    <form method="post">
        {% csrf_token %}
        
        <h3>Dados da Notícia</h3>
        {{ form.as_p }}
        
        <hr>

        <div style="margin-bottom: 20px;">
            <label style="display: inline-flex; align-items: center; gap: 10px; cursor: pointer;">
                <input type="checkbox" id="checkPartida" onchange="togglePartida()">
                <span style="color: rgb(252, 255, 203); font-weight: bold;">Adicionar Partida e Transmissão?</span>
            </label>
        </div>

        <div id="partidaContainer" style="display: none; border: 1px solid violet; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
            <h3 style="color: violet;">Detalhes da Partida</h3>
            {{ partida_form.as_p }}
            
            <hr style="border-color: #444;">
            
            <h3 style="color: violet;">Transmissão (Stream)</h3>
            {{ stream_form.as_p }}
        </div>
        
        <button type="submit" class="btn-custom">Publicar Notícia</button>
    </form>
</div>

<script>
    function togglePartida() {
        const checkbox = document.getElementById('checkPartida');
        const container = document.getElementById('partidaContainer');
        
        if (checkbox.checked) {
            container.style.display = 'block';
        } else {
            container.style.display = 'none';
            // Opcional: Limpar os campos se o usuário desmarcar
            container.querySelectorAll('input, select, textarea').forEach(input => input.value = '');
        }
    }
    
    // Verifica se deve manter aberto (caso tenha havido erro de validação)
    document.addEventListener("DOMContentLoaded", function() {
        // Se algum campo da partida tiver valor, deixamos aberto
        const inputsPartida = document.querySelectorAll('#partidaContainer input');
        let temValor = false;
        inputsPartida.forEach(input => {
            if (input.value) temValor = true;
        });
        
        if(temValor) {
            document.getElementById('checkPartida').checked = true;
            document.getElementById('partidaContainer').style.display = 'block';
        }
    });
</script>
{% endblock %}