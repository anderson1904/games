{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Royal Elixir: A equipe de Clash Royale{% endblock %}</title>
    <meta charset="UTF-8">
    <meta name="author" content="Ana Luiza Saldanha e Nicolly Moura">
    <meta name="description" content="Site Inicial sobre a equipe e o jogo.">

    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Royal Elixir">
    
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_head %}{% endblock %}
</head>

<body>
    <header>
        <div class="logo">
            <img src="{% static 'imgs/logo_royal_elixir.jpg' %}" alt="logo">
            <h1>Royal Elixir</h1>
        </div>
        <nav>
            {% if user.is_authenticated %}
                <a href="{% url 'ver_carrinho' %}" style="display: flex; align-items: center; text-decoration: none; color: rgb(252, 255, 203); font-weight: bold;" title="Meu Carrinho">
                üõí
                </a>
                <div style="display: flex; align-items: center; gap: 10px;">
                    {% if user.Foto_Perfil %}
                        <img src="{{ user.Foto_Perfil.url }}" alt="Foto Perfil" style="height:30px; width:30px; border-radius:50%; vertical-align:middle; object-fit: cover;">
                    {% endif %}
                    <span style="color: rgb(252, 255, 203);">{{ user.username }}</span>
                    <form method="post" action="{% url 'logout' %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" style="background:none; border:none; color:violet; cursor:pointer; font-weight:bold; font-size:16px; font-family: inherit;">Sair</button>
                    </form>
                </div>
            {% else %}
                <a href="{% url 'login' %}">Login</a>
                {% endif %}

            <a href="{% url 'home' %}#sobre">Sobre</a>
            <a href="{% url 'produto_list' %}">Loja</a>
            <a href="{% url 'noticia_list' %}">Not√≠cias</a>
            <a href="{% url 'partida_list' %}">Partidas</a>
            {%if user.is_superuser%}
                <a href="{% url 'lista_pedidos_admin' %}">Pedidos</a>
            {% endif %}
            
            {% block extra-nav-header %}{% endblock %}
        </nav>
    </header>

    {% block content %}
    <section id="sobre">
        <h2>Sobre a equipe e o jogo</h2>
        
        <div class="text-card">
            <div class="text-content">
                <h3>O que √© Clash Royale?</h3>
                <p>
                    <strong>Clash Royale</strong> √© um jogo de estrat√©gia em tempo real criado pela 
                    <strong>Supercell</strong> e lan√ßado em <strong>2 de mar√ßo de 2016</strong>. 
                    O t√≠tulo combina de forma inovadora <em>cartas colecion√°veis</em>, 
                    <em>defesa de torres</em> e batalhas din√¢micas.
                </p>
            </div>
            <div class="text-image">
                <img src="{% static 'imgs/cr_imagen1.jpg' %}" alt="Clash Royale imagem 1">
            </div>
        </div>

        <div class="text-card">
            <div class="text-content">
                <h4>Principais caracter√≠sticas</h4>
                <ul>
                    <li><strong>Cartas colecion√°veis:</strong> desbloqueie, evolua e monte decks com tropas, feiti√ßos e constru√ß√µes √∫nicas.</li>
                    <li><strong>Arenas de batalha:</strong> avance por diferentes arenas conforme conquista vit√≥rias.</li>
                    <li><strong>Cl√£s:</strong> junte-se a outros jogadores para compartilhar cartas, treinar e competir em guerras de cl√£s.</li>
                    <li><strong>Modos de jogo:</strong> participe de partidas r√°pidas 1x1, batalhas cooperativas 2x2 e eventos especiais.</li>
                </ul>
            </div>
            <div class="text-image">
                <img src="{% static 'imgs/cr_imagen2.jpg' %}" alt="Clash Royale imagem 2">
            </div>
        </div>

        <div class="text-card">
            <div class="text-content">
                <h4>Por que jogar?</h4>
                <p>
                    Com uma <strong>jogabilidade acess√≠vel e competitiva</strong>, 
                    Clash Royale oferece partidas curtas, intensas e estrat√©gicas, perfeitas 
                    para momentos casuais ou para desafios no <strong>cen√°rio de eSports</strong>.
                </p>
            </div>
            <div class="text-image">
                <img src="{% static 'imgs/cr_imagen3.jpg' %}" alt="Clash Royale imagem 3">
            </div>
        </div>
    </section>

    <section id="perfil">
        <h2>Nossos Jogadores</h2>
        <div class="players-info" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;">
            {% for jogador in jogadores %}
            <div class="player-card">
                {% if jogador.Foto_Jogador %}
                    <img src="{{ jogador.Foto_Jogador.url }}" alt="Foto de {{ jogador.Nickname }}">
                {% else %}
                    <img src="{% static 'imgs/default_player.png' %}" alt="Sem foto">
                {% endif %}
                
                <div>
                    <h4>{{ jogador.Nome }}</h4>
                    <p>Nickname: {{ jogador.Nickname }}</p>
                    
                    {% if jogador.idade %}
                        <p>Idade: {{ jogador.idade }} Anos</p>
                    {% else %}
                        <p>Idade: N/D</p>
                    {% endif %}
                    
                    <p>Trof√©us: {{ jogador.trofeus }}</p>
                    <p>Sobre: {{ jogador.sobre|truncatechars:30 }}</p>
                </div>
            </div>
            {% empty %}
                <p>Nenhum jogador cadastrado.</p>
            {% endfor %}
        </div>
    </section>


    <section id="loja">
        <h2>Loja</h2>
        <p>Aqui voc√™ poder√° comprar itens exclusivos da equipe Royal Elixir.</p>

        <div class="store">
            {% for produto in produtos %}
            <div class="item">
                <div class="carousel">
                    {% if produto.Foto.all %}
                        {% for foto in produto.Foto.all %}
                            <img src="{{ foto.foto.url }}" class="{% if forloop.first %}active{% endif %}" alt="Foto {{ produto.nome }}">
                        {% endfor %}
                        
                        {% if produto.Foto.count > 1 %}
                            <button class="prev">&#10094;</button>
                            <button class="next">&#10095;</button>
                        {% endif %}
                    {% else %}
                        <img src="{% static 'imgs/no-image.png' %}" class="active" alt="Sem Imagem">
                    {% endif %}
                </div>
                
                <h3>{{ produto.nome }}</h3>
                {% if produto.tbespecifica_set.exists %}
                    <p style="font-size: 0.9rem;">V√°rias op√ß√µes dispon√≠veis</p>
                {% else %}
                    <p>Tamanho √önico</p>
                {% endif %}
                
                <p>R$ {{ produto.preco_venda }}</p>
                
                <a href="{% url 'produto_detail' produto.pk %}" style="display:inline-block; background-color:violet; color:white; padding:8px 15px; border-radius:5px; text-decoration:none; margin-top:10px; font-weight:bold;">Ver Detalhes</a>
            </div>
            {% empty %}
                <p>Nenhum produto dispon√≠vel.</p>
            {% endfor %}
        </div>
    </section>
        
        
    <section id="noticias">
        <h2>√öltimas Not√≠cias</h2>
        <div class="news-container">
            {% for noticia in noticias %}
            <div class="news-card">
                <img src="{% static 'imgs/cr_imagen3.jpg' %}" alt="Imagem not√≠cia" style="width:100%; height:150px; object-fit:cover; border-radius:8px;">
                
                <div class="news-info">
                    <span class="category">ROYAL NEWS</span> | 
                    <span class="date">{{ noticia.tbedita_set.first.Data_Edicao|date:"d/m/Y" }}</span>
                    
                    <h3>{{ noticia.Titulo }}</h3>
                    <p>{{ noticia.TextoHTML|striptags|truncatewords:20 }}</p>
                    
                    <a href="{% url 'noticia_detail' noticia.pk %}" style="color:violet; font-weight:bold;">Saiba mais >></a>
                </div>
            </div>
            {% empty %}
                <p>Nenhuma not√≠cia publicada.</p>
            {% endfor %}
        </div>
    </section>

    <div class="lives" style="text-align: center; margin-top: 50px; padding-bottom: 50px;">
        <h2 style="color: rgb(252, 255, 203);">Transmiss√µes ao Vivo</h2>
        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 20px;">
            <section>
                <p>LIVE DO YOUTUBE</p>
                <iframe width="560" height="315" src="https://www.youtube.com/embed/VIDEO_ID" 
                title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; 
                gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </section>

            <section>
                <p>LIVE DA TWITCH</p>
                <iframe
                src="https://player.twitch.tv/?channel=jacksoono&parent=127.0.0.1"
                frameborder="0"
                allowfullscreen="true"
                scrolling="no"
                height="315"
                width="560">
                </iframe>
            </section>
        </div>
    </div>

    {% endblock %} <script>
        document.querySelectorAll('.carousel').forEach(carousel => {
            const images = carousel.querySelectorAll('img');
            
            // S√≥ ativa se tiver mais de 1 imagem
            if (images.length <= 1) return;

            let currentIndex = 0;

            const showImage = index => {
                images.forEach((img, i) => {
                    img.classList.toggle('active', i === index);
                });
            };

            const prevBtn = carousel.querySelector('.prev');
            const nextBtn = carousel.querySelector('.next');

            if(prevBtn) {
                prevBtn.addEventListener('click', (e) => {
                    e.preventDefault(); // Evita pular a p√°gina ao clicar
                    currentIndex = (currentIndex - 1 + images.length) % images.length;
                    showImage(currentIndex);
                });
            }

            if(nextBtn) {
                nextBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    currentIndex = (currentIndex + 1) % images.length;
                    showImage(currentIndex);
                });
            }
        });
    </script>
    {% block Scripts %}
    {% endblock %}
</body>
</html>